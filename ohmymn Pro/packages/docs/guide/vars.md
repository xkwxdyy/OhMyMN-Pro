# 模版变量

如果你已经学习了 [模版语法](mustache)，那你就可以随意使用下面这些变量了。

::: warning 注意
Metadata 插件暂未发布，目前不开放下载。
:::

::: tip 更新
[v4.2.0](/update.md) ，使用 `date` 代替 `time` 变量。
:::


## 变量

### 脑图卡片

| 变量名 <div style="width:140px"/> | 类型       | 说明                                                           |
| --------------------------------- | ---------- | -------------------------------------------------------------- |
| `id`                              | 字符串     | Note ID                                                        |
| `url.pure`                        | 字符串     | Note URL                                                       |
| `url.md`                          | 字符串     | Note URL，添加 `[]()`                                          |
| `url.html`                        | 字符串     | Note URL，添加 `<a>`                                           |
| `page.start`                      | 字符串     | 笔记在文档中的开始页码                                         |
| `page.end`                        | 字符串     | 笔记在文档中的结束页码                                         |
| `page.real.start`                 | 字符串     | `需要 Metadata` 计算了偏移量后的开始页码。                     |
| `page.real.end`                   | 字符串     | `需要 Metadata` 计算了偏移量后的结束页码。                     |
| ~~`time.creat`~~  `date.create`   | 字符串     | 笔记创建的时间                                                 |
| ~~`time.modify`~~   `date.modify` | 字符串     | 笔记最后修改的时间                                             |
| ~~`time.now`~~      `date.now`    | 字符串     | 当前时间                                                       |
| `allTextPic.text`                 | 字符串     | 卡片中的所有文字，包括 Markdown 插件中的文字。                 |
| `allTextPic.ocr`                  | 字符串     | 卡片中所有文字，图片摘录会自动 OCR，不包括图片评论。           |
| `allTextPic.md`                   | 字符串     | 卡片中的所有文字和图片，图片采用 base64 编码，添加 `![]()`     |
| `allTextPic.html`                 | 字符串     | 卡片中的所有文字和图片，图片采用 base64 编码，添加 `<img src>` |
| `tags`                            | 字符串数组 | 所有标签，没有 #                                               |
| `titles`                          | 字符串数组 | 所有标题                                                       |
| `excerpts.text`                   | 字符串数组 | 所有文字摘录                                                   |
| `excerpts.ocr`                    | 字符串数组 | 所有摘录，图片摘录被 OCR 为文字                                |
| `excerpts.html`                   | 字符串数组 | 所有摘录，图片摘录使用 base64 编码，添加 HTML 标签 `<img>`     |
| `excerpts.md`                     | 字符串数组 | 所有摘录，图片摘录使用 base64 编码，添加 `![]()`               |
| `comments.text`                   | 字符串数组 | 所有文字评论。包括 Markdown 插件中的文字。                     |
| `comments.html`                   | 字符串数组 | 所有评论，包括图片，使用 base64 编码，添加 HTML 标签 `<img>`   |
| `comments.md`                     | 字符串数组 | 所有评论，包括图片，使用 base64 编码，添加 `![]()`             |

### 文档

当前卡片所属的文档

| 变量名 <div style="width:80px"/> | 类型   | 说明                                                              |
| -------------------------------- | ------ | ----------------------------------------------------------------- |
| `doc.title`                      | 字符串 | 文档标题                                                          |
| `doc.md5`                        | 字符串 | 文档 md5                                                          |
| `doc.path`                       | 字符串 | 文件路径                                                          |
| `doc.url.pure`                   | 字符串 | `笔记本里可用` 文档 URL，通过文档中最后一个笔记的链接来间接跳转。 |
| `doc.url.md`                     | 字符串 | `笔记本里可用` 文档 URL，添加 `[]()`                              |
| `doc.url.html`                   | 字符串 | `笔记本里可用` 文档 URL，添加 `<a>`                               |
| `doc.reference`                  | 字符串 | `需要 Metadata` 参考文献/引用                                     |
| `doc.citeKey`                    | 字符串 | `需要 Metadata` Citation key                                      |
| `doc.pageOffset`                 | 字符串 | `需要 Metadata` 文档的页码偏移量                                  |
| `doc.metadata`                   | 对象   | `需要 Metadata` 从 Zotero 中导入的所有元数据                      |

### 笔记本

当前卡片所属的笔记本

| 变量名 <div style="width:150px"/> | 类型   | 说明                    |
| --------------------------------- | ------ | ----------------------- |
| `notebook.title`                  | 字符串 | 笔记本标题              |
| `notebook.id`                     | 字符串 | 笔记本 ID               |
| `notebook.url.pure`               | 字符串 | 笔记本 URL              |
| `notebook.url.md`                 | 字符串 | 笔记本 URL，添加 `[]()` |
| `notebook.url.html`               | 字符串 | 笔记本 URL，添加 `<a>`  |

### 父子卡片

你其实也可以获取到当前卡片的父卡片和子卡片上述所有的信息。

| 变量名     | 类型     | 说明                                            |
| ---------- | -------- | ----------------------------------------------- |
| `parent`   | 对象     | `parent.titles` 表示父卡片的 `titles`           |
| `children` | 对象数组 | `children.0.titles` 表示第一个子卡片的 `titles` |

::: v-pre

## 函数

| 函数名 <div style="width:80px"/> | 说明                                               |
| -------------------------------- | -------------------------------------------------- |
| `nohl`                           | 删除 `**`，也就是重点                              |
| `blod`                           | 将 `**重点**` 修改为 `<b>重点</b>`                 |
| `cloze`                          | 将 `**重点**` 修改为 `{{c1::重点}}`                |
| `clozeSync`                      | 将 `**重点**` 修改为 `{{c1::重点}}`，同时显示答案  |
| `upper`                          | 全部转为大写                                       |
| `lower`                          | 全部转为小写                                       |
| `join`                           | 使用指定的前后修饰来合并字符串数组为一个新的字符串 |
| `fmt`                            | 格式化 `date` 变量                                 |

::: tip 更新
[v4.2.0](/update.md) 使用新的函数语法，新增 `fmt` 函数，比如 `{{ date.now | fmt: "YYYY-mm-dd HH:MM" }}`。
:::

join 函数有两个参数，用来自定义前后修饰，两个参数之间用 `:` 隔开，比如：

```md
{{ titles | join: "" : "; " }}
```

titles 是一个数组，比如 `["标题1", "标题2"]`，那么上面的代码会输出 `标题1; 标题2`。最后一个元素不会添加后缀修饰，所以不会输出 `标题1; 标题2;`。

前缀修饰还可以 [自动编号](./serial.md)，使用 `$['1']`，比如

```md
{{ titles | join: "$['1']. " : "; " }}
```

输出 `1. 标题; 2. 标题`。